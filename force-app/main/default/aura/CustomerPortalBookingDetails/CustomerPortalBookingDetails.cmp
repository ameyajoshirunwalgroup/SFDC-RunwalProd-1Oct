<aura:component controller="CustomerPortalHomeController" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction" access="global" >
   <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:attribute name="RunwalHomeWrapList" type="List" />
     <lightning:navigation aura:id="navService"/>
    <aura:attribute name="isOpen" type="boolean" default="false"/>
    <aura:attribute name="backgroundImageURL" type="String" default=""/> 
    
    <aura:attribute name="Spinner" type="boolean" default="false"/>
     <aura:if isTrue="{!v.Spinner}">
                    <div class="slds-spinner_container">
                        <div class="slds-spinner slds-spinner--medium" aria-hidden="false" role="alert">
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                </aura:if>
    
    <div style="{!'position: relative; background:' + v.backgroundColor + ' url(' + v.backgroundImageURL +') repeat-y;background-position: center;background-size: cover;'}">
    <div class="{!$Browser.isPhone ? 'screenpaddingMobile':'screenPadding'}">
       
		<lightning:card>
            <lightning:tabset selectedTabId="Booking 1">
                 <aura:iteration items="{!v.RunwalHomeWrapList}" var="bookvar" indexVar="index">
                     <lightning:tab label="{!'Booking Details for '+ bookvar.unitNumber}" id="{!'Booking '+ add(index,1)}">
                         <h3 class="slds-section-title--divider slds-border_bottom slds-text-heading_small sectionBackground" style="display:none;">
                <!--<span class="slds-truncate slds-p-horizontal_small slds-size_1-of-1" title="Section Title">Booking Details For {!bookvar.BookingName}</span>-->
            </h3>

            <div class="slds-grid slds-wrap slds-gutters">
                <div class="slds-col slds-size_1-of-1 slds-large-size_9-of-12">
                    <div class="slds-section slds-is-open">
                    <!--<div class="slds-p-top_small"></div>-->
                    <lightning:layout multipleRows="true">
                        <lightning:layoutItem size="12" smallDeviceSize="12" mediumDeviceSize="6" largeDeviceSize="6" flexibility="auto" padding="horizontal-medium" >
                           
                                <div class="slds-page-header slds-text-align_center textInput">
                                <h1 style="font-size:17px;">UNIT DETAILS</h1>
                                </div>
                           
                            <div class="slds-p-top_small"></div>
                            <div class="slds-form" role="list">
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-02">PROJECT NAME</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input readonly="true" type="text" id="single-form-element-id-02" value="{!bookvar.ProjectName}"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-04">TOWER</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02"  value="{!bookvar.TowerName}"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-04">FLOOR NUMBER</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02"  value="{!bookvar.Floor}"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-04">UNIT NUMBER</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02"  value="{!bookvar.unitNumber}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </lightning:layoutItem>
                        <lightning:layoutItem size="12" smallDeviceSize="12" mediumDeviceSize="6" largeDeviceSize="6" flexibility="auto" padding="horizontal-medium" >
                            <div class="slds-page-header slds-text-align_center textInput">
                                <h1 style="font-size:17px;">BOOKING DETAILS</h1>
                            </div>
                            <div class="slds-p-top_small"></div>
                            <div class="slds-form" role="list">
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-02">AGREEMENT VALUE</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02" value="{!bookvar.agreementValue}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-04">SOURCE OF BOOKING</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02"  value="{!bookvar.SourceOfBooking}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open">
                                            <label class="slds-form-element__label slds-p-top_small" for="horizontal-form-element-id-03">DATE OF BOOKING</label>
                                            <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right">
                                                <lightning:input type="text" readonly="true" id="horizontal-form-element-id-03"  value="{!bookvar.BookingDate}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-04">CARPET AREA</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02"  value="{!bookvar.CarpetArea}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-04">NO. OF CAR PARKING</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02" value="{!bookvar.numberofCarParking}"  />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form__row">
                                    <div class="slds-form__item" role="listitem">
                                        <div class="slds-form-element slds-form-element_horizontal slds-is-editing">
                                            <label class="slds-form-element__label slds-p-top_small" for="single-form-element-id-04">PRIMARY EMAIL</label>
                                            <div class="slds-form-element__control">
                                                <lightning:input type="text" readonly="true" id="single-form-element-id-02"  value="{!bookvar.PrimaryApplicantEmail}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </lightning:layoutItem>
                    </lightning:layout>
                    </div>
                </div>
                <div class="slds-col  slds-size_1-of-1 slds-large-size_3-of-12">
                    <div class="slds-p-around_medium">
                        <div class="slds-grid slds-gutters slds-wrap" >
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-1">
                                <div class="slds-p-around_medium">
                                    <!--<button class="slds-button slds-button_brand slds-size_small sizeButton textInput">Preview Booking Form</button>-->
                                    <lightning:button variant="brand" class="sizeButton textInput" name="{!bookvar}" label="Preview Booking Form" title="Preview Booking Form" onclick="{! c.openBookingForm }" />
                                    
                                    
                                </div>
                            </div>
                             <aura:if isTrue="{!not(empty(bookvar.encryptedeoiRecordId))}">
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-1">
                                <div class="slds-p-around_medium">
                                    <!--<button class="slds-button slds-button_brand slds-size_small sizeButton textInput">Preview EOI Form</button>-->
                                    
                                    <lightning:button variant="brand" class="sizeButton textInput" name="{!bookvar}" label="Preview EOI Form" title="Preview EOI Form" onclick="{! c.openEOIForm }" />
                                    
                                </div>
                            </div>
                                 </aura:if>
                        </div>
                        <div class="slds-grid slds-gutters slds-wrap" >
                            
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-1">
                                <div class="slds-p-around_medium">
                                    <!--<button class="slds-button slds-button_brand slds-size_small sizeButton textInput">Review Applicant Details</button>-->
                                    <lightning:button variant="brand" class="sizeButton textInput" name="{!bookvar.BookingId}" label="Review Applicant Details" title="Review Applicant Details" onclick="{! c.openApplicantDetails }" />
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-1">
                                <div class="slds-p-around_medium">
                                    <!--<button class="slds-button slds-button_brand slds-size_small sizeButton textInput">Provide Your Feedback</button>-->
                                	<lightning:button name="{!bookvar}" variant="brand" class="slds-button slds-button_brand slds-size_small  sizeButton textInput"  label="Provide Your Feedback" title="Provide Your Feedback" onclick="{! c.opensurveys }" />
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-1">
                                <div class="slds-p-around_medium">
                                    <!--<button class="slds-button slds-button_brand slds-size_small sizeButton textInput">Provide Your Feedback</button>-->
                                     <aura:if isTrue="{!not(empty(bookvar.agreementDocumentId))}">
                                         <lightning:button name="{!bookvar.agreementDocumentId}" variant="brand" class="slds-button slds-button_brand slds-size_small  sizeButton textInput"  label="View Agreement" title="View Signed Agreement" onclick="{! c.opensignedagreement }" />
                                         <aura:set attribute="else">
                                	<lightning:button name="{!bookvar}" variant="brand" class="slds-button slds-button_brand slds-size_small  sizeButton textInput"  label="View Agreement" title="View Agreement" onclick="{! c.openagreement }" />
                                </aura:set>
                                    </aura:if>
                                         </div>
                            </div>
                        </div>
                    </div>
              
                </div>
            </div>
                          
                     </lightning:tab>
                </aura:iteration>
            </lightning:tabset>
		</lightning:card>
	</div>
        
        <aura:if isTrue="{!v.isOpen}">
    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                   
                    <header class="slds-modal__header">
                        <lightning:buttonIcon iconName="utility:close"
                                              onclick="{! c.closeModel }"
                                              alternativeText="close"
                                              variant="bare-inverse"
                                              class="slds-modal__close"/>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Form in PDF</h2>
                    </header>
                    
                    <iframe aura:id="pdfFrame" src="/resource/lcins1_pdfjs/web/viewer.html" width="100%" height="600px"  class="pdfFrame" ></iframe>
                    
                    
                   
                    <footer class="slds-modal__footer">
                        <lightning:button variant="neutral" 
                                          label="Cancel"
                                          title="Cancel"
                                          onclick="{! c.closeModel }"/>
                       
                    </footer>
                </div>
            </section>
    </aura:if>
        </div>
</aura:component>